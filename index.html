<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tool d·ª± ƒëo√°n md5 - Big Data Edition</title>
    <style>
        /* GI·ªÆ NGUY√äN TO√ÄN B·ªò PH·∫¶N STYLE C·ª¶A B·∫†N (M√¨nh kh√¥ng thay ƒë·ªïi giao di·ªán ƒë·∫πp c·ªßa b·∫°n) */
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@500;700&display=swap');
        :root { --bg: #020617; --panel: rgba(15, 23, 42, 0.8); --neon-blue: #0ea5e9; --neon-pink: #f43f5e; --neon-green: #10b981; --neon-yellow: #f59e0b; --text: #f8fafc; }
        body { background: var(--bg); background: radial-gradient(circle at top right, #1e1b4b, #020617); font-family: 'Rajdhani', sans-serif; color: var(--text); display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; padding: 15px; overflow-x: hidden; }
        body::before { content: ""; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-image: url('https://www.transparenttextures.com/patterns/stardust.png'); opacity: 0.3; pointer-events: none; }
        .container { background: var(--panel); padding: 25px; border-radius: 32px; width: 100%; max-width: 450px; border: 1px solid rgba(56, 189, 248, 0.2); box-shadow: 0 0 40px rgba(0, 0, 0, 0.8), inset 0 0 20px rgba(56, 189, 248, 0.05); backdrop-filter: blur(15px); position: relative; z-index: 1; }
        .header h2 { font-family: 'Orbitron', sans-serif; text-align: center; font-size: 22px; background: linear-gradient(to right, var(--neon-blue), #93c5fd, var(--neon-blue)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; text-transform: uppercase; letter-spacing: 3px; margin-bottom: 25px; filter: drop-shadow(0 0 8px rgba(56, 189, 248, 0.4)); }
        .stats-summary { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; margin-bottom: 25px; }
        .stat-item { background: rgba(0, 0, 0, 0.4); padding: 12px; border-radius: 18px; border: 1px solid rgba(255, 255, 255, 0.05); text-align: center; transition: 0.3s; }
        .stat-item:hover { border-color: var(--neon-blue); }
        .stat-item span { display: block; font-size: 11px; color: #94a3b8; text-transform: uppercase; letter-spacing: 1px; }
        .stat-item b { font-size: 20px; color: #fff; font-family: 'Orbitron'; }
        .input-group { margin-bottom: 20px; position: relative; }
        .label-small { font-size: 12px; color: var(--neon-blue); text-transform: uppercase; font-weight: bold; margin-bottom: 8px; display: flex; align-items: center; gap: 5px; }
        input { width: 100%; padding: 16px; background: rgba(15, 23, 42, 0.6); border: 1px solid rgba(56, 189, 248, 0.2); border-radius: 16px; color: #fff; font-family: 'Orbitron', sans-serif; font-size: 18px; text-align: center; box-sizing: border-box; transition: 0.3s; }
        input:focus { outline: none; border-color: var(--neon-blue); background: rgba(15, 23, 42, 0.9); box-shadow: 0 0 15px rgba(14, 165, 233, 0.3); }
        .btn-main { width: 100%; padding: 20px; background: linear-gradient(135deg, #0284c7, #0ea5e9); color: white; font-family: 'Orbitron', sans-serif; font-weight: 900; border: none; border-radius: 18px; cursor: pointer; text-transform: uppercase; letter-spacing: 2px; transition: 0.4s; box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3); position: relative; overflow: hidden; margin-bottom: 15px; }
        .btn-san { display: block; width: 100%; padding: 15px; background: transparent; color: var(--neon-yellow); border: 2px solid var(--neon-yellow); border-radius: 18px; text-align: center; text-decoration: none; font-family: 'Orbitron', sans-serif; font-weight: 700; text-transform: uppercase; letter-spacing: 2px; transition: 0.3s; box-sizing: border-box; }
        .result-area { margin-top: 30px; padding: 25px; background: rgba(2, 6, 23, 0.8); border-radius: 24px; border: 1px solid var(--neon-blue); animation: slideUp 0.5s ease-out; display: none; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .big-pred { font-size: 65px; font-family: 'Orbitron', sans-serif; font-weight: 900; text-align: center; margin: 10px 0; letter-spacing: -2px; }
        .tai-text { color: var(--neon-pink); filter: drop-shadow(0 0 15px var(--neon-pink)); }
        .xiu-text { color: var(--neon-blue); filter: drop-shadow(0 0 15px var(--neon-blue)); }
        .bar-wrap { height: 30px; background: rgba(255, 255, 255, 0.05); border-radius: 50px; overflow: hidden; display: flex; margin: 20px 0; padding: 3px; border: 1px solid rgba(255, 255, 255, 0.1); }
        .bar-t, .bar-x { width: 50%; height: 100%; border-radius: 50px; display: flex; align-items: center; justify-content: center; font-weight: 900; font-size: 12px; transition: width 1.2s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .bar-t { background: linear-gradient(90deg, #f43f5e, #e11d48); }
        .bar-x { background: linear-gradient(90deg, #0284c7, #38bdf8); }
        .history-detail { font-size: 14px; color: #94a3b8; background: rgba(255, 255, 255, 0.03); padding: 15px; border-radius: 16px; line-height: 1.6; margin-bottom: 20px; border: 1px solid rgba(255, 255, 255, 0.05); }
        .bet-box { background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(16, 185, 129, 0.05)); padding: 20px; border-radius: 20px; border: 1px solid var(--neon-green); text-align: center; margin-bottom: 25px; }
        .bet-money { font-size: 28px; font-weight: 900; color: var(--neon-green); font-family: 'Orbitron'; text-shadow: 0 0 10px rgba(16, 185, 129, 0.5); }
        .feedback-btns { display: flex; gap: 12px; }
        .f-btn { flex: 1; padding: 18px; border: none; border-radius: 16px; font-weight: 900; font-family: 'Orbitron'; cursor: pointer; text-transform: uppercase; transition: 0.3s; }
        .f-win { background: var(--neon-green); color: #064e3b; box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3); }
        .f-loss { background: var(--neon-pink); color: #fff; box-shadow: 0 4px 15px rgba(244, 63, 94, 0.3); }
    </style>
</head>
<body>

<div class="container">
    <div class="header"><h2>CYBERIEND ON HITCLUB</h2></div>

    <div class="stats-summary">
        <div class="stat-item"><span>WINS</span><b id="winCount">0</b></div>
        <div class="stat-item"><span>LOSSES</span><b id="lossCount">0</b></div>
        <div class="stat-item"><span>WIN RATE</span><b id="winRate">0%</b></div>
    </div>

    <div class="input-group">
        <label class="label-small">üí∞ V·ªën hi·ªán t·∫°i</label>
        <input type="number" id="capInput" placeholder="Nh·∫≠p s·ªë VNƒê...">
    </div>

    <div class="input-group">
        <label class="label-small">üìä Chu·ªói l·ªãch s·ª≠ (T/X)</label>
        <input type="text" id="histInput" placeholder="VD: TTTXX..." autocomplete="off">
    </div>

    <button class="btn-main" id="btnMain" onclick="startLoading()">PH√ÇN T√çCH BIG DATA</button>
    <a href="http://hitclub.pro/" target="_blank" class="btn-san">V√ÄO S√ÄN NGAY</a>

    <div id="resArea" class="result-area">
        <div id="finalPred" class="big-pred">--</div>
        <div style="text-align:center;">
            <span style="font-size:11px; color:#64748b; letter-spacing:2px;">ƒê·ªò TIN C·∫¨Y H·ªÜ TH·ªêNG</span>
            <div id="confVal" style="font-size:32px; font-weight:900; font-family:'Orbitron'; color:var(--neon-blue);">0%</div>
        </div>
        <div class="bar-wrap">
            <div id="barT" class="bar-t"></div>
            <div id="barX" class="bar-x"></div>
        </div>
        <div id="historyDetail" class="history-detail"></div>
        <div class="bet-box">
            <span class="label-small" style="color:var(--neon-green); margin-bottom:5px;">L·ªÜNH V√ÄO TI·ªÄN</span>
            <div id="moneyVal" class="bet-money">0 VNƒê</div>
            <div id="betPercent" style="font-size:12px; color:#94a3b8; margin-top:5px;">(ƒê·ª£i ph√¢n t√≠ch...)</div>
        </div>
        <div class="feedback-btns">
            <button class="f-btn f-win" onclick="recordFeedback(true)">TH·∫ÆNG ‚úÖ</button>
            <button class="f-btn f-loss" onclick="recordFeedback(false)">THUA ‚ùå</button>
        </div>
    </div>
</div>

<script>
    // ‚ö†Ô∏è THAY LINK GOOGLE SCRIPT C·ª¶A B·∫†N V√ÄO ƒê√ÇY
    const GOOGLE_SHEET_URL = "https://script.google.com/macros/s/AKfycbxaVIYCkkyrs_94FzlrjxDyezqxkntpB3ixqJfBd7S9-5c5t6JElOSbw3-G5zJthv0/exec";
    let wins = 0, losses = 0, lastPrediction = "", currentBet = 0;

    async function startLoading() {
        const btn = document.getElementById('btnMain');
        btn.innerText = "ƒêANG T·∫¢I D·ªÆ LI·ªÜU T·ª™ SHEET...";
        btn.disabled = true;
        btn.style.opacity = "0.6";

        try {
            // B∆∞·ªõc 1: G·ªçi l·ªánh GET ƒë·ªÉ l·∫•y d·ªØ li·ªáu l·ªãch s·ª≠ t·ª´ Google Sheet
            const response = await fetch(GOOGLE_SHEET_URL);
            const sheetData = await response.json();
            
            // B∆∞·ªõc 2: B·∫Øt ƒë·∫ßu ph√¢n t√≠ch
            runAnalysis(sheetData);
            
        } catch (error) {
            console.error("L·ªói l·∫•y d·ªØ li·ªáu:", error);
            alert("Kh√¥ng k·∫øt n·ªëi ƒë∆∞·ª£c v·ªõi Google Sheet. ƒêang d√πng d·ªØ li·ªáu c·ª•c b·ªô.");
            runAnalysis([]); // Ch·∫°y t·∫°m b·∫±ng d·ªØ li·ªáu nh·∫≠p tay n·∫øu l·ªói m·∫°ng
        } finally {
            btn.innerText = "PH√ÇN T√çCH H·ªÜ TH·ªêNG";
            btn.disabled = false;
            btn.style.opacity = "1";
        }
    }

    function runAnalysis(sheetData) {
        let cap = parseInt(document.getElementById('capInput').value) || 0;
        let rawCurrent = document.getElementById('histInput').value.toUpperCase().replace(/[^TX]/g, '');
        if (rawCurrent.length < 3) { alert("Nh·∫≠p √≠t nh·∫•t 3 phi√™n g·∫ßn nh·∫•t!"); return; }

        // Gom d·ªØ li·ªáu: D·ªØ li·ªáu t·ª´ Sheet + D·ªØ li·ªáu v·ª´a nh·∫≠p tay
        let oldHistory = sheetData.map(row => row[1]).join(''); // C·ªôt B trong Sheet
        let fullData = oldHistory + rawCurrent;
        let dataArray = fullData.split('');
        
        let pattern = rawCurrent.slice(-3).join ? rawCurrent.slice(-3).join('') : rawCurrent.slice(-3);
        let cT = 0, cX = 0, matches = 0;

        // Soi m·∫´u trong to√†n b·ªô kho d·ªØ li·ªáu Big Data
        for (let i = 0; i < dataArray.length - 3; i++) {
            if (dataArray.slice(i, i+3).join('') === pattern) {
                matches++;
                if (dataArray[i+3] === 'T') cT++; else cX++;
            }
        }

        // T√≠nh t·ª∑ l·ªá %
        let pT = 50, pX = 50;
        if (matches > 0) {
            pT = Math.round((cT / (cT + cX)) * 100);
            pX = 100 - pT;
        }

        // Logic b·ªï tr·ª£ nh·ªãp c·∫ßu hi·ªán t·∫°i
        let lastChar = rawCurrent[rawCurrent.length-1];
        let streak = 0;
        for (let i = rawCurrent.length-1; i >= 0; i--) {
            if (rawCurrent[i] === lastChar) streak++; else break;
        }

        if (streak >= 4) {
            if (lastChar === 'T') pT += 15; else pX += 15;
        }

        pT = Math.min(98, Math.max(2, pT)); 
        pX = 100 - pT;
        lastPrediction = pT >= pX ? 'T' : 'X';
        let conf = Math.max(pT, pX);

        // Hi·ªÉn th·ªã giao di·ªán
        document.getElementById('resArea').style.display = 'block';
        let pDiv = document.getElementById('finalPred');
        pDiv.innerText = lastPrediction === 'T' ? "T√ÄI" : "X·ªàU";
        pDiv.className = "big-pred " + (lastPrediction === 'T' ? "tai-text" : "xiu-text");
        document.getElementById('confVal').innerText = conf + "%";
        
        document.getElementById('barT').style.width = pT + "%";
        document.getElementById('barX').style.width = pX + "%";
        document.getElementById('barT').innerText = pT > 20 ? pT+"% T" : "";
        document.getElementById('barX').innerText = pX > 20 ? pX+"% X" : "";

        document.getElementById('historyDetail').innerHTML = `
            H·ªá th·ªëng ph√°t hi·ªán <b>${matches}</b> l·∫ßn m·∫´u [${pattern}] xu·∫•t hi·ªán trong l·ªãch s·ª≠.<br>
            K·∫øt qu·∫£ qu√° kh·ª©: <b>${cT} T√†i - ${cX} X·ªâu</b>.
        `;

        let rate = conf >= 90 ? 0.1 : (conf >= 75 ? 0.05 : 0.02);
        currentBet = Math.floor(cap * rate);
        document.getElementById('moneyVal').innerText = currentBet.toLocaleString('vi-VN') + " VNƒê";
        document.getElementById('betPercent').innerText = `G·ª£i √Ω v√†o: ${(rate*100)}% v·ªën`;

        window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
    }

    async function recordFeedback(isWin) {
        let h = document.getElementById('histInput');
        let res = isWin ? lastPrediction : (lastPrediction === "T" ? "X" : "T");
        
        // G·ª≠i d·ªØ li·ªáu l√™n Sheet ƒë·ªÉ h·ªçc cho l·∫ßn sau
        fetch(GOOGLE_SHEET_URL, {
            method: 'POST', 
            mode: 'no-cors', 
            body: JSON.stringify({
                history: h.value, 
                prediction: lastPrediction, 
                status: isWin ? "WIN" : "LOSS", 
                capital: document.getElementById('capInput').value, 
                betAmount: currentBet
            })
        });

        if (isWin) wins++; else losses++;
        h.value += res;
        document.getElementById('winCount').innerText = wins;
        document.getElementById('lossCount').innerText = losses;
        document.getElementById('winRate').innerText = Math.round((wins/(wins+losses))*100) + "%";
        document.getElementById('resArea').style.display = 'none';
    }
</script>
</body>
</html>
